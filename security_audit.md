# Security Audit Report - Apex RAG

**Date**: 2026-01-26T21:30:00-06:00  
**Tool**: OSV Scanner 2.3.2  
**Lockfile**: `uv.lock` (169 packages)

## Summary

| Severity | Count | Mitigated |
|----------|-------|-----------|
| Critical | 0 | - |
| High | 3 | ✅ All |
| Medium | 0 | - |
| Low | 0 | - |

## Vulnerabilities

### 1. pdfminer-six - GHSA-wf5f-4jwr-ppcp (CVSS 8.6)

**Description**: Remote Code Execution via malicious PDF referencing pickle files. On Windows, network paths (SMB/WebDAV) can be used to load malicious pickle files remotely.

**Affected Version**: 20231228  
**Fixed Version**: 20251230 (not yet available in docling's deps)

**Mitigation Applied**: ✅
- `src/security/pdf_security.py`: `is_network_path()` blocks all UNC, SMB, WebDAV, and mapped network drive paths
- `validate_file_path()` rejects network paths before processing

### 2. pdfminer-six - GHSA-f83h-ghpp-7wcc (CVSS 7.8)

**Description**: Privilege escalation via CMAP_PATH pickle injection. Attackers can write malicious pickle files to shared directories.

**Affected Version**: 20231228  
**Fixed Version**: 20251230 (not yet available in docling's deps)

**Mitigation Applied**: ✅
- `src/security/pdf_security.py`: `isolated_processing_environment()` sets CMAP_PATH to an ephemeral temp directory
- No shared directories are exposed during PDF processing

### 3. protobuf - GHSA-7gcm-g887-7qv7 (CVSS 8.2)

**Description**: Denial of Service via deeply nested protobuf `Any` messages that bypass recursion limits.

**Affected Version**: 6.33.4  
**Fixed Version**: No fix available yet

**Mitigation Applied**: ✅
- `src/security/pdf_security.py`: `with_recursion_limit()` enforces conservative recursion limits
- `with_timeout()` terminates processing that exceeds time limits

## Usage

### Run Security Audit
```powershell
# Using OSV Scanner
& "C:\Users\skrae\Desktop\Dev Tools\rag_and_memory\tools\osv-scanner.exe" scan --lockfile uv.lock

# Using uv-secure
uv-secure uv.lock
```

### Use Security Wrappers
```python
from src.security import secure_pdf_processor, TrustLevel

@secure_pdf_processor(trust_level=TrustLevel.UNTRUSTED)
def process_pdf(file_path):
    # Your PDF processing logic here
    # Security mitigations are automatically applied
    ...
```

## Recommended Actions

1. **Update when available**: Monitor for pdfminer-six >= 20251230
2. **Update when available**: Monitor for protobuf security fix
3. **Regular audits**: Run `osv-scanner` before each release
4. **Use trust levels**: Mark external PDFs as `TrustLevel.UNTRUSTED`

---

*Generated by Apex RAG Security Audit*
